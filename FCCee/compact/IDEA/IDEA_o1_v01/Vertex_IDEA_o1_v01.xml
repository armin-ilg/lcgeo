<!-- Changes :
   o4_v04 : scaled version of the CLIC VTX Barrel (CLIC_04_v11); distance between sensitive layers in double layers are set to 1*mm and is similar in all 3 layers
-->

<lccdd>

    <info name="FCCee"
        title="FCCee Vertex detector: taken correspoding to CLD: Vertex_o4_v05.xml, but adapted to IDEA vertex detector"
        author="nalipour taken from lcgeo (CLD version), adapted by Armin Ilg (IDEA version)"
        url="no"
        status="development"
        version="1.1">
    <comment>A Vertex Detector for FCCee IDEA detector concept</comment>
  </info>

    <comment>Tracking detectors</comment>
    <detectors>
        <detector name="Vertex" type="DD4hep_SubdetectorAssembly" vis="VXDVis">
            <shape type="BooleanShape" operation="Subtraction" material="Air">
                <shape type="BooleanShape" operation="Subtraction">
                    <shape type="Tube" rmin="VertexInnerBarrel_r_min-VertexInnerBarrel_r_clearance" rmax="VertexOuterBarrel_r_min" dz="Outer_Vertex_half_length"/>
                    <shape type="Cone" rmin1="0" rmax1="VertexClearanceTheta*Outer_Vertex_half_length-env_safety" rmin2="0" rmax2="VertexInnerBarrel_r_min-VertexInnerBarrel_r_clearance" z="((Outer_Vertex_half_length-CentralBeamPipe_zmax)/2+env_safety)"/>
                    <position x="0" y="0" z="-(CentralBeamPipe_zmax+(Outer_Vertex_half_length-CentralBeamPipe_zmax)/2+env_safety)" />
                </shape>
                
                <shape type="Cone" rmin1="0" rmax1="VertexInnerBarrel_r_min-VertexInnerBarrel_r_clearance" rmin2="0" rmax2="VertexClearanceTheta*Outer_Vertex_half_length-env_safety" z="(Outer_Vertex_half_length-CentralBeamPipe_zmax)/2+env_safety"/>
                <position x="0" y="0" z="CentralBeamPipe_zmax+(Outer_Vertex_half_length-CentralBeamPipe_zmax)/2+env_safety" />
            </shape>
            <comment>Vertex Assembly</comment>
            <composite name="VertexInnerBarrel"/>
            <composite name="VertexOuterBarrel"/>
            <composite name="VertexDisks"/>
        </detector>
    </detectors>
    
    <display>
        <vis name="SiVertexSensitiveVis" alpha="1.0" r="0.5" g="0.5"  b="0"     showDaughters="true"  visible="true"/>
        <vis name="SiVertexPeripheryVis" alpha="1.0" r="0.6" g="0.5"  b="0"     showDaughters="true"  visible="true"/>
        <vis name="SiVertexCableVis"     alpha="1.0" r="0.85" g="0.53"    b="0.4"       showDaughters="true"  visible="true"/>
        <vis name="CarbonFiberVis"       alpha="1.0" r="0.5" g="0.5"    b="0.5"       showDaughters="true"  visible="true"/>
        <vis name="SiVertexAir"          alpha="1.0" r="0" g="0"    b="0"       showDaughters="false"  visible="false"/>
        <vis name="SiVertexDisksSensitiveVis" alpha="1.0" r="0.5" g="0.5"  b="0"     showDaughters="true"  visible="true"/>
        <vis name="SiVertexDisksPeripheryVis" alpha="1.0" r="0.6" g="0.5"  b="0"     showDaughters="true"  visible="true"/>
    </display>
     
    <define>
        <!-- Needed for DDCAD import (I think, need to check) -->
        <constant name="unit_length" value="1*10"/>
        <constant name="unit_pos"    value="unit_length/10"/>
        <constant name="CheckShape_create"   value="0"/>

        <!-- Sensor characteristics -->

        <!-- Vertex inner barrel -->
            <!-- Let's take the ARCADIA chip! -->
            <constant name="VertexInnerBarrel_sens_z" value="1.6*cm"/> <!-- Chip length, use modified ARCADIA with length of 1.6cm instead of 2.56cm-->       
            <constant name="VertexInnerBarrel_sens_rphi_sensitive" value="6.4*mm"/> <!-- Chip length: Sensitive-->
            <constant name="VertexInnerBarrel_sens_rphi_periphery" value="2*mm"/> <!-- Chip length: Periphery-->
            <constant name="VertexInnerBarrel_sens_rphi" value="VertexInnerBarrel_sens_rphi_sensitive+VertexInnerBarrel_sens_rphi_periphery"/> <!-- Chip length: Sensitive-->
    
            <!-- Module with two ARCADIA chips -->
            <constant name="VertexInnerBarrel_mod_z" value="VertexInnerBarrel_sens_z*2"/> 
            <constant name="VertexInnerBarrel_mod_rphi_sensitive" value="VertexInnerBarrel_sens_rphi_sensitive"/> 
            <constant name="VertexInnerBarrel_mod_rphi_periphery" value="VertexInnerBarrel_sens_rphi_periphery"/>
            <constant name="VertexInnerBarrel_mod_rphi" value="VertexInnerBarrel_sens_rphi"/>

        <!-- Vertex outer barrel + disks -->
            <!-- ATLASPix3-like -->
            <constant name="VertexOuter_sens_z_sensitive" value="19.8*mm"/> <!-- Chip length in z: Sensitive -->
            <constant name="VertexOuter_sens_z_periphery" value="0.4*mm"/> <!-- Chip length in z: Periphery -->
            <constant name="VertexOuter_sens_z" value="VertexOuter_sens_z_sensitive+VertexOuter_sens_z_periphery"/> <!-- Chip length in z: Total -->
            <constant name="VertexOuter_sens_rphi_sensitive" value="18.6*mm"/> <!-- Chip length in r-phi: Sensitive-->
            <constant name="VertexOuter_sens_rphi_periphery" value="2.4*mm"/> <!-- Chip length in r-phi: Periphery-->
            <constant name="VertexOuter_sens_rphi" value="VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_periphery"/> <!-- Chip length in r-phi: Total -->
            <constant name="VertexOuter_sens_rphi_sens_spacing" value="2*mm"/> <!-- Distance between individual readout chips in rphi -->
            <constant name="VertexOuter_sens_z_sens_spacing" value="2*mm"/> <!-- Distance between individual readout chips in rphi -->
    
            <!-- Module with four ATLASPix3-like chips -->
            <constant name="VertexOuter_mod_z_sensitive" value="VertexOuter_sens_z_sensitive*2"/>
            <constant name="VertexOuter_mod_z_periphery" value="VertexOuter_sens_z_periphery*2"/>
            <constant name="VertexOuter_mod_z" value="VertexOuter_mod_z_sensitive+VertexOuter_mod_z_periphery"/>
    
            <constant name="VertexOuter_mod_rphi_sensitive" value="VertexOuter_sens_rphi_sensitive*2"/>
            <constant name="VertexOuter_mod_rphi_periphery" value="VertexOuter_sens_rphi_periphery*2"/>
            <constant name="VertexOuter_mod_rphi" value="VertexOuter_mod_rphi_sensitive+VertexOuter_mod_rphi_periphery"/>
        

        <!-- Vertex inner barrel -->
            <constant name="VertexInnerBarrel_Layer1_Staves" value="15"/>
            <constant name="VertexInnerBarrel_Layer2_Staves" value="24"/>
            <constant name="VertexInnerBarrel_Layer3_Staves" value="18"/>
            
            <constant name="VertexInnerBarrel_Layer1_nModules" value="6"/>
            <constant name="VertexInnerBarrel_Layer2_nModules" value="10"/>
            <constant name="VertexInnerBarrel_Layer3_nModules" value="16"/>
    
            <constant name="VertexInnerBarrel_mod_z_spacing" value="0.2*mm"/>
    
            <constant name="VertexInnerBarrel_z1" value="(VertexInnerBarrel_Layer1_nModules*VertexInnerBarrel_mod_z+(VertexInnerBarrel_Layer1_nModules-1)*VertexInnerBarrel_mod_z_spacing)/2."/>
            <constant name="VertexInnerBarrel_z2" value="(VertexInnerBarrel_Layer2_nModules*VertexInnerBarrel_mod_z+(VertexInnerBarrel_Layer2_nModules-1)*VertexInnerBarrel_mod_z_spacing)/2."/>
            <constant name="VertexInnerBarrel_z3" value="(VertexInnerBarrel_Layer3_nModules*VertexInnerBarrel_mod_z+(VertexInnerBarrel_Layer3_nModules-1)*VertexInnerBarrel_mod_z_spacing)/2."/>        
            <constant name="VertexInnerBarrel_r1" value="VertexInnerBarrel_r_min"/> 
            <constant name="VertexInnerBarrel_r2" value="2.27*cm"/>

            <constant name="VertexInnerBarrel_r3_lowR_1" value="3.305*cm"/> <!-- Closer double-stave, stave at lower r -->
            <constant name="VertexInnerBarrel_r3_lowR_2" value="VertexInnerBarrel_r3_lowR_1+0.950*mm"/> <!-- Closer double-stave, stave at higher r -->
            <constant name="VertexInnerBarrel_r3_highR_1" value="3.460*cm"/> <!-- Farther double-stave, stave at lower r -->
            <constant name="VertexInnerBarrel_r3_highR_2" value="VertexInnerBarrel_r3_highR_1+0.8*mm"/> <!-- Farther double-stave, stave at higher r -->

            <constant name="VertexInnerBarrel_Sensitive_Thickness"   value="50e-03*mm"/>
            <constant name="VertexInnerBarrel_Support_Thickness"     value="200e-03*mm"/> <!-- +50% more material budget as in CLIC VTX -->
    
            <constant name="VertexInnerBarrel_Layer3_overlap" value="0.4*mm"/>        
            
            <constant name="VertexInnerBarrel_Layer1_offset" value="3.751*mm"/>
            <constant name="VertexInnerBarrel_Layer2_offset" value="-3.255*mm"/>
            <constant name="VertexInnerBarrel_Layer3_offset" value="2*mm"/>

        <!-- Flex for inner vertex barrel readout, assume 100 µm total thickness, with two 18 µm Aluminium layers and the rest kapton-->
            <constant name="VertexInnerBarrel_flex_width" value="1.8*mm"/>
            <constant name="VertexInnerBarrel_flex_offset" value="VertexInnerBarrel_sens_rphi/2.-VertexInnerBarrel_flex_width/2.-0.25*mm"/>
            <constant name="VertexInnerBarrel_flex_Aluminium_thickness" value="0.050*mm"/>
            <constant name="VertexInnerBarrel_flex_Kapton_thickness" value="0.200*mm"/>

        <!-- Vertex disks  -->
            <constant name="VertexDisks_rmax1" value="247.644*mm"/>
            <constant name="VertexDisks_rmax2" value="289.595*mm"/>
            <constant name="VertexDisks_rmax3" value="289.595*mm"/>
            <constant name="VertexDisks_rmax" value="VertexDisks_rmax3"/>        
            <constant name="VertexDisks_z1" value="285*mm"/>
            <constant name="VertexDisks_z2" value="620*mm"/>
            <constant name="VertexDisks_z3" value="930*mm"/>
            <constant name="VertexDisks_rmin1" value="35.64*mm"/>
            <constant name="VertexDisks_rmin2" value="76.995*mm"/>
            <constant name="VertexDisks_rmin3" value="105.895*mm"/>
            <constant name="VertexDisks_dr1" value="0.92*mm"/>  <!-- Alternating difference in radius from one petal to the next -->
            <constant name="VertexDisks_dr2" value="(153.99*mm-152.30*mm)/2."/>
            <constant name="VertexDisks_dr3" value="0.0*mm"/>  <!-- Alternating difference in radius from one petal to the next -->
            <constant name="VertexDisks_phi1A" value="0.0*rad"/>
            <constant name="VertexDisks_phi1B" value="0.7853981634*rad"/> <!-- face B of first disk is offset by 45 degrees-->
            <constant name="VertexDisks_zoffset_stave" value="6.020*mm"/>
            <constant name="VertexDisks_zoffset_face" value="19.1412*mm"/> <!-- face B has different position in z than face A-->
            <constant name="VertexDisks_stave_dz" value="5.0*mm"/> <!-- Distance between front and back of stave (inner empty space) -->

            <constant name="VertexDisksModuleThickness" value="1.22*mm"/>
            <constant name="VertexDisksModOverlap" value="-13.0*mm"/>
            <constant name="VertexDisks_rModOverlap" value="-6.5*mm"/>

            <constant name="VertexDisks_Sensitive_Thickness"   value="5.000000000e-02*mm"/>

        <!-- Vertex outer barrel -->
            <constant name="VertexOuterBarrel_Staves1" value="23"/>
            <constant name="VertexOuterBarrel_Staves2" value="51"/>
            <constant name="VertexOuterBarrel_nModules1" value="8"/>
            <constant name="VertexOuterBarrel_nModules2" value="16"/>
            <constant name="VertexOuterBarrel_mod_z_spacing" value="0.2*mm"/>
            <constant name="VertexOuterBarrel_mod_rphi_spacing" value="0.2*mm"/>
    
            <constant name="VertexOuterBarrel_z1" value="(VertexOuterBarrel_nModules1*VertexOuter_mod_z+(VertexOuterBarrel_nModules1-1)*VertexOuterBarrel_mod_z_spacing)/2."/>
            <constant name="VertexOuterBarrel_z2" value="(VertexOuterBarrel_nModules2*VertexOuter_mod_z+(VertexOuterBarrel_nModules2-1)*VertexOuterBarrel_mod_z_spacing)/2."/>
            <constant name="VertexOuterBarrel_r1" value="140*mm"/>
            <constant name="VertexOuterBarrel_r2" value="315*mm"/>
            <constant name="VertexOuterBarrel_tilt" value="0.0*rad"/>  
            <constant name="VertexOuterBarrel_Sensitive_Thickness"              value="5e-02*mm"/>

            <constant name="VertexOuter_support_Fleece_thickness"         value="20e-03*mm"/>
            <constant name="VertexOuter_support_CarbonFiber_thickness"    value="120e-03*mm"/>
            <constant name="VertexOuter_support_PaperGraphite_thickness"  value="25e-03*mm"/>
            <constant name="VertexOuterBarrel_Support_thickness"          value="2.0*VertexOuter_support_Fleece_thickness+VertexOuter_support_CarbonFiber_thickness+VertexOuter_support_PaperGraphite_thickness"/>
            <constant name="VertexDisks_Support_thickness"          value="VertexOuter_support_Fleece_thickness+VertexOuter_support_CarbonFiber_thickness+VertexOuter_support_PaperGraphite_thickness"/>

            <constant name="VertexOuterBarrel_rphi_sensitive" value="VertexOuter_mod_rphi_sensitive"/>
    
            <constant name="VertexOuterBarrel_rphi_periphery" value="VertexOuter_mod_rphi_periphery"/>
    
            <constant name="VertexOuterBarrel_rphi" value="VertexOuterBarrel_rphi_sensitive+VertexOuterBarrel_rphi_periphery"/>
    
            <constant name="VertexOuterBarrel_offset1" value="10.0*mm"/>
            <constant name="VertexOuterBarrel_offset2" value="20.0*mm"/>


        <!-- Flex for outer tracker: 2 layers of 50 µm Aluminum, 2 layers of 150 µm kapton and 100 µm glue -->
            <constant name="VertexOuter_flex_width" value="16.2*mm"/>
            <constant name="VertexOuter_flex_Aluminium_thickness" value="0.100*mm"/>
            <constant name="VertexOuter_flex_Kapton_thickness" value="0.300*mm"/>
            <constant name="VertexOuter_flex_Glue_thickness" value="0.100*mm"/>
            <constant name="VertexOuter_flex_thickness" value="VertexOuter_flex_Aluminium_thickness+VertexOuter_flex_Kapton_thickness+VertexOuter_flex_Glue_thickness"/>
    </define>        


    <!--  Definition of the readout segmentation/definition  -->
    <readouts>
        <readout name="VertexInnerBarrelCollection">
            <id>${GlobalTrackerReadoutID}</id>
        </readout>
        <readout name="VertexOuterBarrelCollection">
            <id>${GlobalTrackerReadoutID}</id>
        </readout>       
        <readout name="VertexDisksCollection">
            <id>${GlobalTrackerReadoutID}</id>
        </readout>
    </readouts>

    <!-- Vertex inner barrel -->
    <detectors>
        <detector name="VertexInnerBarrel" type="VertexBarrel_detailed_o1_v01" vis="VXDVis" id="DetID_VXD_InnerBarrel" readout="VertexInnerBarrelCollection"  region="VertexInnerBarrelRegion">

            <type_flags type=" DetType_TRACKER + DetType_PIXEL + DetType_VERTEX + DetType_BARREL"/>

            <layer nLadders="VertexInnerBarrel_Layer1_Staves" phi0="4./360.*2*pi*rad" phi_tilt="0.0" id="0">
                <sensitive distance="VertexInnerBarrel_r1" thickness="VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi_sensitive" length="VertexInnerBarrel_z1" offset="VertexInnerBarrel_Layer1_offset-VertexInnerBarrel_mod_rphi_periphery/2." material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexInnerBarrel_Layer1_nModules" dz="VertexInnerBarrel_mod_z_spacing" z_length="VertexInnerBarrel_mod_z"/>

                <ladder distance="VertexInnerBarrel_r1+VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z1" offset="VertexInnerBarrel_Layer1_offset" material="CarbonFiber"  vis="CarbonFiberVis">
                    <support thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z1" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="0*mm"/>
                </ladder>
                <module_envelope width="VertexInnerBarrel_mod_rphi_periphery" length="0.0*mm" type="1" vis="SiVertexPeripheryVis"/>

                <readout width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z1" distance="VertexInnerBarrel_r1+VertexInnerBarrel_Support_Thickness+VertexInnerBarrel_Sensitive_Thickness" offset="VertexInnerBarrel_Layer1_offset" vis="SiVertexCableVis">
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z1" distance="0.0*mm" offset="VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z1" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z1" distance="0.0*mm" offset="-VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z1" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="-VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                </readout>
            </layer>

            <layer nLadders="VertexInnerBarrel_Layer2_Staves" phi0="0" phi_tilt="0.0" id="1">
                <sensitive distance="VertexInnerBarrel_r2" thickness="VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi_sensitive" length="VertexInnerBarrel_z2" offset="VertexInnerBarrel_Layer2_offset-VertexInnerBarrel_mod_rphi_periphery/2.0" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexInnerBarrel_Layer2_nModules" dz="VertexInnerBarrel_mod_z_spacing" z_length="VertexInnerBarrel_mod_z"/>
                <module_envelope width="VertexInnerBarrel_mod_rphi_periphery" length="0.0*mm" type="1" vis="SiVertexPeripheryVis"/>

                <ladder distance="VertexInnerBarrel_r2+VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z2" offset="VertexInnerBarrel_Layer2_offset"    material="CarbonFiber"  vis="CarbonFiberVis">
                    <support thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z2" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="0*mm"/>
                </ladder>

                <readout width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z2" distance="VertexInnerBarrel_r2+VertexInnerBarrel_Support_Thickness+VertexInnerBarrel_Sensitive_Thickness" offset="VertexInnerBarrel_Layer2_offset" vis="SiVertexCableVis">
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z2" distance="0.0*mm" offset="VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z2" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z2" distance="0.0*mm" offset="-VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z2" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="-VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                </readout>
            </layer>

            <!-- Closer double-stave, stave at lower r -->
            <layer nLadders="VertexInnerBarrel_Layer3_Staves/2." phi0="0" phi_tilt="0.0" id="2">
                <sensitive distance="VertexInnerBarrel_r3_lowR_1" thickness="VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi_sensitive" length="VertexInnerBarrel_z3" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_mod_rphi_sensitive/2.0" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexInnerBarrel_Layer3_nModules" dz="VertexInnerBarrel_mod_z_spacing" z_length="VertexInnerBarrel_mod_z"/>
                <module_envelope width="VertexInnerBarrel_mod_rphi_periphery" length="0.0*mm" type="1" vis="SiVertexPeripheryVis"/>

                <ladder distance="VertexInnerBarrel_r3_lowR_1+VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z3" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_mod_rphi/2"    material="CarbonFiber"  vis="CarbonFiberVis">
                    <support thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z3" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="0*mm"/>
                </ladder>

                <readout width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_r3_lowR_1+VertexInnerBarrel_Support_Thickness+VertexInnerBarrel_Sensitive_Thickness" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_mod_rphi/2" vis="SiVertexCableVis">
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="0.0*mm" offset="VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="0.0*mm" offset="-VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="-VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                </readout>
            </layer>

            <!-- Closer double-stave, stave at higher r -->
            <layer nLadders="VertexInnerBarrel_Layer3_Staves/2." phi0="0" phi_tilt="0.0" id="3">
                <sensitive distance="VertexInnerBarrel_r3_lowR_2" thickness="VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi_sensitive" length="VertexInnerBarrel_z3" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_Layer3_overlap-VertexInnerBarrel_mod_rphi_sensitive/2.0" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexInnerBarrel_Layer3_nModules" dz="VertexInnerBarrel_mod_z_spacing" z_length="VertexInnerBarrel_mod_z"/> <!-- Inverted direction-->
                <module_envelope width="VertexInnerBarrel_mod_rphi_periphery" length="0.0*mm" type="-1" vis="SiVertexPeripheryVis"/>

                <ladder    distance="VertexInnerBarrel_r3_lowR_2+VertexInnerBarrel_Sensitive_Thickness" thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z3" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_Layer3_overlap-VertexInnerBarrel_mod_rphi/2.0"    material="CarbonFiber"  vis="CarbonFiberVis">
                    <support thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z3" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="0*mm"/>
                </ladder>

                <readout width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_r3_lowR_2+VertexInnerBarrel_Support_Thickness+VertexInnerBarrel_Sensitive_Thickness" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_Layer3_overlap-VertexInnerBarrel_mod_rphi/2" vis="SiVertexCableVis">
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="0.0*mm" offset="VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="0.0*mm" offset="-VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="-VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                </readout>
            </layer>

            <!-- Farther double-stave, stave at lower r -->
            <layer nLadders="VertexInnerBarrel_Layer3_Staves/2." phi0="2*pi/VertexInnerBarrel_Layer3_Staves*rad" phi_tilt="0.0" id="4">
                <sensitive distance="VertexInnerBarrel_r3_highR_1" thickness="VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi_sensitive" length="VertexInnerBarrel_z3" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_mod_rphi_sensitive/2.0" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexInnerBarrel_Layer3_nModules" dz="VertexInnerBarrel_mod_z_spacing" z_length="VertexInnerBarrel_mod_z"/>
                <module_envelope width="VertexInnerBarrel_mod_rphi_periphery" length="0.0*mm" type="1" vis="SiVertexPeripheryVis"/>

                <ladder distance="VertexInnerBarrel_r3_highR_1+VertexInnerBarrel_Sensitive_Thickness" thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z3" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_mod_rphi/2"    material="CarbonFiber"  vis="CarbonFiberVis">
                    <support thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z3" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="0*mm"/>
                </ladder>

                <readout width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_r3_highR_1+VertexInnerBarrel_Support_Thickness+VertexInnerBarrel_Sensitive_Thickness" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_mod_rphi/2" vis="SiVertexCableVis">
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="0.0*mm" offset="VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="0.0*mm" offset="-VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="-VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                </readout>
            </layer>

            <!-- Farther double-stave, stave at higher r -->
            <layer nLadders="VertexInnerBarrel_Layer3_Staves/2." phi0="2*pi/VertexInnerBarrel_Layer3_Staves*rad" phi_tilt="0.0" id="5">
                <sensitive distance="VertexInnerBarrel_r3_highR_2" thickness="VertexInnerBarrel_Sensitive_Thickness" width="VertexInnerBarrel_mod_rphi_sensitive" length="VertexInnerBarrel_z3" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_Layer3_overlap-VertexInnerBarrel_mod_rphi_sensitive/2.0" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexInnerBarrel_Layer3_nModules" dz="VertexInnerBarrel_mod_z_spacing" z_length="VertexInnerBarrel_mod_z"/> <!-- Inverted direction-->
                <module_envelope width="VertexInnerBarrel_mod_rphi_periphery" length="0.0*mm" type="-1" vis="SiVertexPeripheryVis"/>

                <ladder    distance="VertexInnerBarrel_r3_highR_2+VertexInnerBarrel_Sensitive_Thickness" thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z3" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_Layer3_overlap-VertexInnerBarrel_mod_rphi/2.0"    material="CarbonFiber"  vis="CarbonFiberVis">
                    <support thickness="VertexInnerBarrel_Support_Thickness" width="VertexInnerBarrel_mod_rphi" length="VertexInnerBarrel_z3" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="0*mm"/>
                </ladder>

                <readout width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_r3_highR_2+VertexInnerBarrel_Support_Thickness+VertexInnerBarrel_Sensitive_Thickness" offset="VertexInnerBarrel_Layer3_offset+VertexInnerBarrel_Layer3_overlap-VertexInnerBarrel_mod_rphi/2" vis="SiVertexCableVis">
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="0.0*mm" offset="VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Kapton_thickness"       width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="0.0*mm" offset="-VertexInnerBarrel_flex_offset" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexInnerBarrel_flex_Aluminium_thickness"    width="VertexInnerBarrel_flex_width" length="VertexInnerBarrel_z3" distance="VertexInnerBarrel_flex_Kapton_thickness" offset="-VertexInnerBarrel_flex_offset" material="Al" vis="SiVertexCableVis"/>
                </readout>
            </layer>
        </detector>
    </detectors>

    <!-- Vertex outer barrel -->
    <detectors>
        <detector name="VertexOuterBarrel" type="VertexBarrel_detailed_o1_v01" vis="VXDVis" id="DetID_VXD_OuterBarrel" readout="VertexOuterBarrelCollection"  region="VertexOuterBarrelRegion">
            <envelope vis="VXDVis">
                <shape type="Assembly"/>
            </envelope>
            <comment>Vertex Detector Outer Barrel</comment>
            <sensitive type="SimpleTrackerSD"/>

            <!-- Order of layers: 688 um power-bus stave flex, 50 um silicon sensor, 20 um carbon fleece grafite, 120 um carbon fiber, 25 um carbon paper-grafite, 20 um carbon fleece grafite -->
            <!-- Module width: 42.2 mm -->
            <type_flags type=" DetType_TRACKER + DetType_PIXEL + DetType_VERTEX + DetType_BARREL"/>

            <layer nLadders="VertexOuterBarrel_Staves1" phi0="0" phi_tilt="VertexOuterBarrel_tilt" id="0">
                <!-- Readout: Flex along the stave -->
                <readout width="VertexOuter_flex_width" length="VertexOuterBarrel_z1" distance="VertexOuterBarrel_r1" offset="VertexOuterBarrel_offset1" vis="SiVertexCableVis">
                    <component thickness="VertexOuter_flex_Aluminium_thickness"    width="VertexOuter_flex_width" length="VertexOuterBarrel_z1" distance="0.0*mm" offset="0.0*mm" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexOuter_flex_Kapton_thickness"       width="VertexOuter_flex_width" length="VertexOuterBarrel_z1" distance="VertexOuter_flex_Aluminium_thickness" offset="0.0*mm" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexOuter_flex_Glue_thickness"         width="VertexOuter_flex_width" length="VertexOuterBarrel_z1" distance="VertexOuter_flex_Aluminium_thickness+VertexOuter_flex_Kapton_thickness" offset="0.0*mm" material="Glue" vis="SiVertexCableVis"/> <!-- NEED TO USE CORRECT GLUE DESCRIPTION!-->
                </readout>

                <!-- Then the sensor, not implemented separate passive periphery -->
                <sensitive distance="VertexOuterBarrel_r1+VertexOuter_flex_thickness" thickness="VertexOuterBarrel_Sensitive_Thickness" width="VertexOuterBarrel_rphi_sensitive" length="VertexOuterBarrel_z1" offset="VertexOuterBarrel_offset1-VertexOuterBarrel_rphi_periphery/2." material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexOuterBarrel_nModules1" dz="VertexOuterBarrel_mod_z_spacing" z_length="VertexOuter_mod_z"/>
                <!-- with its passive periphery -->
                <module_envelope width="VertexOuterBarrel_rphi_periphery" length="0.0*mm" type="1" vis="SiVertexPeripheryVis"/>

                <!-- Support structure -->
                <ladder distance="VertexOuterBarrel_r1+VertexOuter_flex_thickness+VertexOuterBarrel_Sensitive_Thickness" width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z1" offset="VertexOuterBarrel_offset1" material="CarbonFiber" vis="CarbonFiberVis">
                    <support thickness="VertexOuter_support_Fleece_thickness"         width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z1" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="0*mm"/> <!-- should be material="CarbonFleeceGraphite", not implemented yet! -->
                    <support thickness="VertexOuter_support_PaperGraphite_thickness"  width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z1" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="VertexOuter_support_Fleece_thickness"/> <!-- should be material="CarbonPaperGraphite", not implemented yet! -->
                    <support thickness="VertexOuter_support_CarbonFiber_thickness"    width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z1" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="VertexOuter_support_Fleece_thickness+VertexOuter_support_PaperGraphite_thickness"/>
                    <support thickness="VertexOuter_support_Fleece_thickness"         width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z1" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="VertexOuter_support_Fleece_thickness+VertexOuter_support_PaperGraphite_thickness+VertexOuter_support_CarbonFiber_thickness"/> <!-- should be material="CarbonFleeceGraphite", not implemented yet! -->
                </ladder>
            </layer>

            <layer nLadders="VertexOuterBarrel_Staves2" phi0="0" phi_tilt="VertexOuterBarrel_tilt" id="1">
                <!-- First comes the support structure -->
                <ladder distance="VertexOuterBarrel_r2" width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z2" offset="VertexOuterBarrel_offset2"    material="CarbonFiber"  vis="CarbonFiberVis">
                    <support thickness="VertexOuter_support_Fleece_thickness"         width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z2" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="0*mm"/> <!-- should be material="CarbonFleeceGraphite", not implemented yet! -->
                    <support thickness="VertexOuter_support_PaperGraphite_thickness"  width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z2" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="VertexOuter_support_Fleece_thickness"/> <!-- should be material="CarbonPaperGraphite", not implemented yet! -->
                    <support thickness="VertexOuter_support_CarbonFiber_thickness"    width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z2" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="VertexOuter_support_Fleece_thickness+VertexOuter_support_PaperGraphite_thickness"/>
                    <support thickness="VertexOuter_support_Fleece_thickness"         width="VertexOuterBarrel_rphi" length="VertexOuterBarrel_z2" offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis" distance="VertexOuter_support_Fleece_thickness+VertexOuter_support_PaperGraphite_thickness+VertexOuter_support_CarbonFiber_thickness"/> <!-- should be material="CarbonFleeceGraphite", not implemented yet! -->
                </ladder>

                <!-- Then the sensor, not implemented separate passive periphery -->
                <sensitive distance="VertexOuterBarrel_r2+VertexOuterBarrel_Support_thickness" thickness="VertexOuterBarrel_Sensitive_Thickness" width="VertexOuterBarrel_rphi_sensitive" length="VertexOuterBarrel_z2" offset="VertexOuterBarrel_offset2-VertexOuterBarrel_rphi_periphery/2." material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexOuterBarrel_nModules2" dz="VertexOuterBarrel_mod_z_spacing" z_length="VertexOuter_mod_z"/>
                <!-- with its passive periphery -->
                <module_envelope width="VertexOuterBarrel_rphi_periphery" length="0.0*mm" type="1" vis="SiVertexPeripheryVis"/>

                <!-- Readout: Flex along the stave -->
                <readout width="VertexOuter_flex_width" length="VertexOuterBarrel_z2" distance="VertexOuterBarrel_r2+VertexOuterBarrel_Support_thickness+VertexOuterBarrel_Sensitive_Thickness" offset="VertexOuterBarrel_offset2" vis="SiVertexCableVis">
                    <component thickness="VertexOuter_flex_Aluminium_thickness"    width="VertexOuter_flex_width" length="VertexOuterBarrel_z1" distance="0.0*mm" offset="0.0*mm" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexOuter_flex_Kapton_thickness"       width="VertexOuter_flex_width" length="VertexOuterBarrel_z1" distance="VertexOuter_flex_Aluminium_thickness" offset="0.0*mm" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexOuter_flex_Glue_thickness"         width="VertexOuter_flex_width" length="VertexOuterBarrel_z1" distance="VertexOuter_flex_Aluminium_thickness+VertexOuter_flex_Kapton_thickness" offset="0.0*mm" material="Glue" vis="SiVertexCableVis"/> <!-- NEED TO USE CORRECT GLUE DESCRIPTION!-->
                </readout>
            </layer>
        </detector>
    </detectors>
    
    <!-- Vertex disks -->
    <detectors>
        <detector id="DetID_VXD_Disks" name="VertexDisks" type="VertexEndcap_detailed_o1_v01" readout="VertexDisksCollection" reflect="true" region="VertexDisksRegion">
            <envelope vis="VXDVis">
                <shape type="Assembly"/>
            </envelope>
            <comment>Vertex Detector Endcaps</comment>
            <sensitive type="SimpleTrackerSD"/>

            <type_flags type=" DetType_TRACKER + DetType_PIXEL + DetType_VERTEX + DetType_ENDCAP"/>
            <module name="SiVertexDisksModule">
                <!-- Order of layers: 688 um power-bus stave flex, 50 um silicon sensor, 20 um carbon fleece grafite, 120 um carbon fiber, 25 um carbon paper-grafite -->

                <!-- Flex at low-z -->
                <readout z_offset="0.0*mm">
                    <component thickness="VertexOuter_flex_Aluminium_thickness"    width="VertexOuter_flex_width" offset="0.0*mm" z_offset="0.0*mm" material="Al" vis="SiVertexCableVis"/>
                    <component thickness="VertexOuter_flex_Kapton_thickness"       width="VertexOuter_flex_width" offset="0.0*mm" z_offset="VertexOuter_flex_Aluminium_thickness" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexOuter_flex_Glue_thickness"         width="VertexOuter_flex_width" offset="0.0*mm" z_offset="VertexOuter_flex_Aluminium_thickness+VertexOuter_flex_Kapton_thickness" material="Glue" vis="SiVertexCableVis"/> <!-- NEED TO USE CORRECT GLUE DESCRIPTION!-->
                </readout>

                <!-- Sensor -->
                <sensor z_offset="VertexOuter_flex_thickness" thickness="VertexOuterBarrel_Sensitive_Thickness" material="Silicon">
                    <component sensitive="False" xmin="-(VertexOuter_sens_z_sensitive+VertexOuter_sens_z_periphery+VertexOuter_sens_z_sens_spacing/2.0)" xmax="-(VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0)"                ymin="-(VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_periphery+VertexOuter_sens_rphi_sens_spacing/2.0)" ymax="VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_periphery+VertexOuter_sens_rphi_sens_spacing/2.0"    vis="SiVertexDisksPeripheryVis"/> <!-- top Quad periphery-->
                    <component sensitive="False" xmin="VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0"                      xmax="VertexOuter_sens_z_sensitive+VertexOuter_sens_z_periphery+VertexOuter_sens_z_sens_spacing/2.0" ymin="-(VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_periphery+VertexOuter_sens_rphi_sens_spacing/2.0)" ymax="VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_periphery+VertexOuter_sens_rphi_sens_spacing/2.0"    vis="SiVertexDisksPeripheryVis"/> <!-- bottom Quad periphery-->   
                    <component sensitive="False" xmin="-(VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0)"                   xmax="VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0"                   ymin="-(VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_periphery+VertexOuter_sens_rphi_sens_spacing/2.0)" ymax="-(VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_sens_spacing/2.0)"                      vis="SiVertexDisksPeripheryVis"/> <!-- left Quad periphery-->   
                    <component sensitive="False" xmin="-(VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0)"                   xmax="VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0"                   ymin="VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_sens_spacing/2.0"                         ymax="VertexOuter_sens_rphi_sensitive+VertexOuter_sens_rphi_periphery+VertexOuter_sens_rphi_sens_spacing/2.0"    vis="SiVertexDisksPeripheryVis"/> <!-- right Quad periphery-->   

                    <component sensitive="False" xmin="VertexOuter_sens_z_sens_spacing/2.0"                        xmax="VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0"   ymin="-VertexOuter_sens_rphi_sens_spacing/2.0"                         ymax="VertexOuter_sens_rphi_sens_spacing/2.0"                          vis="SiVertexDisksPeripheryVis"/> <!-- Middle cross: right -->
                    <component sensitive="False" xmin="-(VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0)"   xmax="-VertexOuter_sens_z_sens_spacing/2.0"                    ymin="-VertexOuter_sens_rphi_sens_spacing/2.0"                         ymax="VertexOuter_sens_rphi_sens_spacing/2.0"                          vis="SiVertexDisksPeripheryVis"/> <!-- Middle cross: left -->
                    <component sensitive="False" xmin="-VertexOuter_sens_z_sens_spacing/2.0"                       xmax="VertexOuter_sens_z_sens_spacing/2.0"                     ymin="VertexOuter_sens_rphi_sens_spacing/2.0"                          ymax="VertexOuter_sens_rphi_sens_spacing/2.0+VertexOuter_sens_rphi_sensitive"     vis="SiVertexDisksPeripheryVis"/> <!-- Middle cross: top -->
                    <component sensitive="False" xmin="-VertexOuter_sens_z_sens_spacing/2.0"                       xmax="VertexOuter_sens_z_sens_spacing/2.0"                     ymin="-(VertexOuter_sens_rphi_sens_spacing/2.0+VertexOuter_sens_rphi_sensitive)"  ymax="-VertexOuter_sens_rphi_sens_spacing/2.0"                         vis="SiVertexDisksPeripheryVis"/> <!-- Middle cross: bottom -->
                    <component sensitive="False" xmin="-VertexOuter_sens_z_sens_spacing/2.0"                       xmax="VertexOuter_sens_z_sens_spacing/2.0"                     ymin="-VertexOuter_sens_rphi_sens_spacing/2.0"                         ymax="VertexOuter_sens_rphi_sens_spacing/2.0"                          vis="SiVertexDisksPeripheryVis"/> <!-- Middle cross: centre -->
                    
                    <component sensitive="True" xmin="-VertexOuter_sens_z_sensitive-VertexOuter_sens_z_sens_spacing/2.0"  xmax="-VertexOuter_sens_z_sens_spacing/2.0"                    ymin="VertexOuter_sens_rphi_sens_spacing/2.0"                          ymax="VertexOuter_sens_rphi_sens_spacing/2.0+VertexOuter_sens_rphi_sensitive" vis="SiVertexDisksSensitiveVis"/> <!-- top left sensitive-->
                    <component sensitive="True" xmin="VertexOuter_sens_z_sens_spacing/2.0"                     xmax="VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0"   ymin="VertexOuter_sens_rphi_sens_spacing/2.0"                          ymax="VertexOuter_sens_rphi_sens_spacing/2.0+VertexOuter_sens_rphi_sensitive" vis="SiVertexDisksSensitiveVis"/> <!-- top right sensitive-->                    
                    <component sensitive="True" xmin="-VertexOuter_sens_z_sensitive-VertexOuter_sens_z_sens_spacing/2.0"  xmax="-VertexOuter_sens_z_sens_spacing/2.0"                    ymin="-VertexOuter_sens_rphi_sens_spacing/2.0-VertexOuter_sens_rphi_sensitive"    ymax="-VertexOuter_sens_rphi_sens_spacing/2.0"                     vis="SiVertexDisksSensitiveVis"/> <!-- bottom left sensitive-->                    
                    <component sensitive="True" xmin="VertexOuter_sens_z_sens_spacing/2.0"                     xmax="VertexOuter_sens_z_sensitive+VertexOuter_sens_z_sens_spacing/2.0"   ymin="-VertexOuter_sens_rphi_sens_spacing/2.0-VertexOuter_sens_rphi_sensitive"    ymax="-VertexOuter_sens_rphi_sens_spacing/2.0"                     vis="SiVertexDisksSensitiveVis"/> <!-- bottom right sensitive--> 
                </sensor>

                <!-- low-z support -->
                <support z_offset="VertexOuter_flex_thickness+VertexOuterBarrel_Sensitive_Thickness">
                    <component thickness="VertexOuter_support_Fleece_thickness"         width="VertexOuter_mod_z" offset="0.0*mm" z_offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis"/> <!-- should be material="CarbonFleeceGraphite", not implemented yet! -->
                    <component thickness="VertexOuter_support_CarbonFiber_thickness"    width="VertexOuter_mod_z" offset="0.0*mm" z_offset="VertexOuter_support_Fleece_thickness" material="CarbonFiber" vis="CarbonFiberVis"/>
                    <component thickness="VertexOuter_support_PaperGraphite_thickness"  width="VertexOuter_mod_z" offset="0.0*mm" z_offset="VertexOuter_support_Fleece_thickness+VertexOuter_support_CarbonFiber_thickness" material="CarbonFiber" vis="CarbonFiberVis"/> <!-- should be material="CarbonPaperGraphite", not implemented yet! -->
                </support>

                <!-- high-z support -->
                <support z_offset="VertexOuter_flex_thickness+VertexOuterBarrel_Sensitive_Thickness+VertexDisks_stave_dz">
                    <component thickness="VertexOuter_support_PaperGraphite_thickness"  width="VertexOuter_mod_z" offset="0.0*mm" z_offset="0.0*mm" material="CarbonFiber" vis="CarbonFiberVis"/> <!-- should be material="CarbonPaperGraphite", not implemented yet! -->
                    <component thickness="VertexOuter_support_CarbonFiber_thickness"    width="VertexOuter_mod_z" offset="0.0*mm" z_offset="VertexOuter_support_PaperGraphite_thickness" material="CarbonFiber" vis="CarbonFiberVis"/>
                    <component thickness="VertexOuter_support_Fleece_thickness"         width="VertexOuter_mod_z" offset="0.0*mm" z_offset="VertexOuter_support_PaperGraphite_thickness+VertexOuter_support_CarbonFiber_thickness" material="CarbonFiber" vis="CarbonFiberVis"/> <!-- should be material="CarbonFleeceGraphite", not implemented yet! -->
                </support>

                <!-- Flex at high-z -->
                <readout z_offset="VertexOuter_flex_thickness+2.0*(VertexOuterBarrel_Sensitive_Thickness+VertexDisks_Support_thickness)+VertexDisks_stave_dz">
                    <component thickness="VertexOuter_flex_Glue_thickness"         width="VertexOuter_flex_width" offset="0.0*mm" z_offset="0.0*mm" material="Glue" vis="SiVertexCableVis"/> <!-- NEED TO USE CORRECT GLUE DESCRIPTION!-->
                    <component thickness="VertexOuter_flex_Kapton_thickness"       width="VertexOuter_flex_width" offset="0.0*mm" z_offset="VertexOuter_flex_Glue_thickness" material="Kapton" vis="SiVertexCableVis"/>
                    <component thickness="VertexOuter_flex_Aluminium_thickness"    width="VertexOuter_flex_width" offset="0.0*mm" z_offset="VertexOuter_flex_Glue_thickness+VertexOuter_flex_Kapton_thickness" material="Al" vis="SiVertexCableVis"/>
                </readout>
            </module>

            <layer id="0" z="VertexDisks_z1" nphi="4" dz="0.0*mm" rmin="VertexDisks_rmin1" dr="VertexDisks_dr1" phi0="0.0">
                <stave nmodules="2" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="0.0*mm" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="3" z_offset="VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="1.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="4" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="2.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="4" z_offset="VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="3.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="5" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="4.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="6" z_offset="VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="5.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>

                <stave nmodules="2" z_offset="VertexDisks_zoffset_face" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="0.0*mm" step="VertexDisksModOverlap" phi0="VertexDisks_phi1B" module="SiVertexDisksModule"/>
                <stave nmodules="3" z_offset="VertexDisks_zoffset_face+VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="1.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1B" module="SiVertexDisksModule"/>
                <stave nmodules="4" z_offset="VertexDisks_zoffset_face" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="2.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1B" module="SiVertexDisksModule"/>
                <stave nmodules="5" z_offset="VertexDisks_zoffset_face+VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="3.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1B" module="SiVertexDisksModule"/>
                <stave nmodules="5" z_offset="VertexDisks_zoffset_face" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="4.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1B" module="SiVertexDisksModule"/>
                <stave nmodules="6" z_offset="VertexDisks_zoffset_face+VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="5.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" step="VertexDisksModOverlap" phi0="VertexDisks_phi1B" module="SiVertexDisksModule"/>
            </layer>

            <layer id="1" z="VertexDisks_z2" nphi="8" dz="VertexDisks_zoffset_face" rmin="VertexDisks_rmin2" dr="VertexDisks_dr2" phi0="0.0">
                <stave nmodules="3" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="0.0*mm" dr="VertexDisks_dr2" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="4" z_offset="VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="1.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr2" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="5" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="2.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr2" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="6" z_offset="VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="3.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr2" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="7" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="4.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr2" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="8" z_offset="VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="5.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr2" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
            </layer>        

            <layer id="2" z="VertexDisks_z3" nphi="8" dz="VertexDisks_zoffset_face" rmin="VertexDisks_rmin3" dr="VertexDisks_dr3" phi0="0.0">
                <stave nmodules="4" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="0.0*mm" dr="VertexDisks_dr3" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="5" z_offset="VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="1.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr3" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="5" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="2.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr3" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="6" z_offset="VertexDisks_zoffset_stave" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="3.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr3" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
                <stave nmodules="7" z_offset="0.0*mm" dz="VertexDisks_Support_thickness+VertexDisks_stave_dz+VertexDisks_Support_thickness" r="4.*(VertexOuter_mod_z+VertexDisks_rModOverlap)" dr="VertexDisks_dr3" step="VertexDisksModOverlap" phi0="VertexDisks_phi1A" module="SiVertexDisksModule"/>
            </layer>
        </detector>
    </detectors>

    <plugins>
        <plugin name="DD4hep_GenericSurfaceInstallerPlugin">
            <argument value="VertexDisks"/> 
            <argument value="dimension=2"/>
            <argument value="u_x=-1."/>
            <argument value="v_y=1."/>
            <argument value="n_z=-1."/>
        </plugin>
    </plugins>

    <!-- Vertex inner barrel support -->
    <detectors>
        <detector id="0" name="Shape_STL" type="DD4hep_TestShape_Creator">
            <check>
                <shape type="CAD_MultiVolume" ref="./Assieme_supporti_carbonio.stl" unit="cm">
                    <volume id="0" name="s1" vis="Shape3_vis" material="ConicalSupport"/>
                    <position x="104.3837*cm"  y="-1.7417*cm"        z="-33.7602*cm"/>
                    <rotation x="0*pi/8*rad" y="-4*pi/8*rad" z="0*rad"/>  
                </shape>
            </check>
        </detector>
    </detectors>
</lccdd>
